<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>D.S POS SYSTEMS</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/homePage.css" rel="stylesheet">
    <script src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js" type="module"></script>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a aria-current="page" id="homePage" class="nav-link active btn" ><b>DS Stores</b></a>
                </li>
                <li class="nav-item">
                    <a aria-current="page" id="register" class="nav-link active btn" >Register</a>
                </li>
                <li class="nav-item">
                    <a aria-current="page" id="placeOrder" class="nav-link active btn" >Place Order</a>
                </li>
                <li class="nav-item">
                    <a aria-current="page" id="orderHistory" class="nav-link active btn" >Order History</a>
                </li>
            </ul>
            <a aria-current="page" href="alter-projects/taskView.html" target="_blank" id="SPA" class="nav-link active btn-success me-4" >Tasks</a>
        </div>
    </div>
</nav>

<div id="cont-01" class="container" >
    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="assets/img/ProduceX.jpg" style="height: 92.2vh" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block mb-5">
                    <h5 class="fw-bold">WELCOME TO THE D.S STORE (pvt ltd)</h5>

                    <div class="card-col">
                        <div class="card mt-3 mb-3 me-4" style="width: 18rem;">
                            <img src="assets/img/rb.jpg" style="height: 200px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Delivery</h5>
                                <p class="card-text">We Deliver the goods at your door step with given minimum time</p>
                            </div>

                        </div>
                        <div class="card mt-3 mb-3 me-4" style="width: 18rem;">
                            <img src="assets/img/dis2.jpg" style="height: 200px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Discounts</h5>
                                <p class="card-text">Upto 30% Discounts, when you are paying with BOC, Sampath Debit Cards</p>
                            </div>

                        </div>
                        <div class="card mt-3 mb-3 me-4" style="width: 18rem;">
                            <img src="assets/img/safe1.jpg" style="height: 200px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Safety</h5>
                                <p class="card-text">We are highly considering the safety guidelines for the customer 100%</p>
                            </div>

                        </div>
                    </div>

                    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur error eveniet laudantium nihil quidem
                        quo? A facere in molestias quis ratione tempore ut veniam voluptates! Accusantium eaque optio perspiciatis
                        reprehenderit.</p>
                    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur error eveniet laudantium nihil quidem
                        quo? A facere in molestias quis ratione tempore ut veniam voluptates! Accusantium eaque optio perspiciatis
                        reprehenderit.</p>
                </div>
            </div>

            <div class="carousel-item">
                <img src="assets/img/pg2.jpg" style="height: 92.2vh" class="d-block w-100" alt="...">
                <div class="carousel-caption d-none d-md-block mb-5">
                    <h5>WELCOME TO THE STORE</h5>

                    <div class="card-col mt-4">
                        <div class="card mt-3 mb-3 me-4" style="width: 22rem;">
                            <img src="assets/img/4600.jpg" style="height: 170px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Items</h5>
                                <p class="card-text">4600+ Daily-need Items For You with amazing discounts!!</p>
                            </div>

                        </div>
                        <div class="card mt-3 mb-3 me-4" style="width: 22rem;">
                            <img src="assets/img/20000.jpg" style="height: 170px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Orders</h5>
                                <p class="card-text">20K+ Orders had done from ore store upto now !!</p>
                            </div>

                        </div>
                        <div class="card mt-3 mb-3 me-4" style="width: 22rem;">
                            <img src="assets/img/6500.jpg" style="height: 170px" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title text-light">Customers</h5>
                                <p class="card-text">6.5K Valuable Customers has taken membership of our store </p>
                            </div>

                        </div>
                    </div>

                    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur error eveniet laudantium nihil quidem
                        quo? A facere in molestias quis ratione tempore ut veniam voluptates! Accusantium eaque optio perspiciatis
                        reprehenderit.</p>
                    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur error eveniet laudantium nihil quidem
                        quo? A facere in molestias quis ratione tempore ut veniam voluptates! Accusantium eaque optio perspiciatis
                        reprehenderit.</p>
                </div>
            </div>

        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>
<div id="cont-02" class="container" style="display: none">

    <div class="row" style="height: 90vh">

        <div class="col" style="height: 90vh">
            <div class="row">
                <div class="col-md-6">
                    <h3 class="mx-auto mt-lg-2 text-lg-center ms-5" id="reg-item-head" style="color: #c2b09d">Register a Item</h3>
                </div>
            </div>

            <div class="row" style="height: 84vh">
                <form id="itemForm">
                    <div class="mb-3">
                        <label for="txtItemCode" id="lblItemId" class="form-label">Item Code</label>
                        <div class="row">
                            <div class="col-10">
                                <input type="text" name="itemCode" class="form-control" id="txtItemCode" aria-describedby="nameHelp" placeholder="Item Code">
                            </div>
                            <div class="col-1">
                                <button type="button"  style="border-radius: 40%">
                                    <img src="assets/img/preview.png" id="btnGenerateItemId" style="width: 30px">
                                </button>
                            </div>
                        </div>
                        <p class="text-danger float-end txtReq" id="req-txtItemCode"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtItemName" class="form-label">Name</label>
                        <input type="text" name="itemName" class="form-control" id="txtItemName" aria-describedby="nameHelp" placeholder="Item Name">
                        <p class="text-danger float-end txtReq" id="req-txtItemName"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtUnitPrice" class="form-label">Unit Price</label>
                        <input type="text" name="unitPrice" class="form-control" id="txtUnitPrice" aria-describedby="nameHelp" placeholder="Unit Price">
                        <p class="text-danger float-end txtReq" id="req-txtItemPrice"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtQty" class="form-label">Quantity</label>
                        <input type="text" name="qty" class="form-control" id="txtQty" aria-describedby="nameHelp" placeholder="Qty">
                        <p class="text-danger float-end txtReq" id="req-txtItemQty"></p>
                    </div>

                    <button id="clearItemFields" type="button"> Clear </button>
                    <div class="row mt-2">
                        <div class="col-3 float-start mt-2">
                            <input type="text" class="form-control" style="width: 10vw" id="txtSearchItem" aria-describedby="nameHelp" placeholder="Search Item">
                        </div>
                        <div class="col float-end mt-2">
                            <button id="dltItem" class="btn btn-danger float-end mb-2 me-3" type="button"> Delete Item </button>
                            <button class="btn btn-success float-end mb-2 me-3" id="updateItem" type="button"> Update Item </button>
                            <button id="addNewItem" class="btn btn-dark float-end mb-2 me-3" type="button"> Add Item </button>
                            <button id="btnSrchItem" class="btn btn-warning ms-3 mb-2" type="button"> Search </button>
                        </div>
                    </div>
                </form>

                <section class="shadow-lg table-responsive table-wrap3">
                    <table class="table table-bordered table-hover mt-2 text-light" id="itemTable">
                        <thead class="bg-dark text-white">
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Unit Price</th>
                                <th>Quantity</th>
                            </tr>
                        </thead>
                        <tbody id="item-body">
                        </tbody>
                    </table>
                </section>

            </div>
        </div>

        <div class="col" style="height: 90vh">

            <div class="row">
                <div class="col-md-6">
                    <h3 class="mx-auto mt-lg-2 text-lg-center ms-5" style="color: #c2b09d">Register a Customer</h3>
                </div>
            </div>

            <div class="row two" style="height: 84vh">
                <form id="customerForm">
                    <div class="mb-3">
                        <label for="txtCustomerId" class="form-label">Customer Id</label>
                        <div class="row">
                            <div class="col-10">
                                <input type="text" class="form-control" name="customerId" id="txtCustomerId" aria-describedby="telHelp" placeholder="Customer Id">
                            </div>
                            <div class="col-1">
                                <button type="button" style="border-radius: 40%">
                                    <img src="assets/img/preview.png" id="btnGenerateCustomerId" style="width: 30px">
                                </button>
                            </div>
                        </div>
                        <p class="text-danger float-end txtReq" id="req-txtCusId"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtCustomerName" class="form-label">Name</label>
                        <input type="text" class="form-control" name="customerName" id="txtCustomerName" aria-describedby="nameHelp" placeholder="Customer Name">
                        <p class="text-danger float-end txtReq" id="req-txtCusName"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtEmail" class="form-label">Email address</label>
                        <input type="email" class="form-control" name="customerEmail" id="txtEmail" aria-describedby="emailHelp" placeholder="Email Address">
                        <p class="text-danger float-end txtReq" id="req-txtCusAddress"></p>
                    </div>
                    <div class="mb-3">
                        <label for="txtTelNo" class="form-label">Tel No</label>
                        <input type="text" class="form-control" name="customerTelNo" id="txtTelNo" aria-describedby="telHelp" placeholder="Telephone">
                        <p class="text-danger float-end txtReq" id="req-txtCusTel"></p>
                    </div>

                    <button id="clearCusFields" type="button"> Clear </button>

                    <div class="row mt-2">
                        <div class="col-3 float-start mt-2">
                            <input type="text" class="form-control" style="width: 10vw" id="txtSearchCustomer" aria-describedby="nameHelp" placeholder="Search Item">
                        </div>

                        <div class="col float-end mt-2">
                            <button type="button" id="btnDeleteCustomer" class="btn btn-danger float-end mb-2 me-3"> Delete Cust</button>
                            <button type="button" id="updateCustomer" class="btn btn-success float-end mb-2 me-3"> Update Cust </button>
                            <button id="addNewCustomer" type="button" class="btn btn-dark float-end mb-2 me-3"> Add Cust</button>
                            <button id="btnSrchCustomer" class="btn btn-warning ms-3 mb-2" type="button"> Search </button>
                        </div>
                    </div>
                </form>

                <section class="shadow-lg table-responsive table-wrap3">
                    <table class="table table-bordered table-hover mt-2 text-light" id="customerTable">
                        <thead class="bg-dark text-white">
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Telephone</th>
                        </tr>
                        </thead>
                        <tbody id="customer-body">
                        </tbody>
                    </table>
                </section>
            </div>
        </div>
    </div>
</div>
<div id="cont-03" class="container" style="display: none">

    <div class="row mt-lg-5">
        <div class="col-md-4">
            <div class="row">
                <div class="col-md-6">
                    <h3 class="mx-auto mt-lg-5 text-lg-center ms-5" style="color: #c2b09d">Add To Cart</h3>
                </div>
            </div>

            <div class="row">
                <form>
                    <div class="form-group mt-4">
                        <select class="custom-select" id="customerID-selector" required>
                            <option value="">Empty List</option>
                        </select>
                        <div class="invalid-feedback">Example invalid custom select feedback</div>
                    </div>

                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" disabled id="customName" aria-describedby="telHelp" placeholder="Customer Name">
                    </div>
                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" disabled id="customAddress" aria-describedby="telHelp" placeholder="Email Address">
                    </div>
                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" disabled id="customTelNo" aria-describedby="telHelp" placeholder="Telephone">
                    </div>

                    <hr>

                    <div class="form-group mt-4">
                        <select class="custom-select" id="itemID-selector" required>
                            <option value="">Empty List</option>
                        </select>
                        <div class="invalid-feedback">Example invalid custom select feedback</div>
                    </div>

                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" disabled id="itemName" aria-describedby="telHelp" placeholder="Item Name">
                    </div>
                    <div class="mb-3 mt-3">
                        <input type="text" class="form-control" disabled id="unitPrice" aria-describedby="telHelp" placeholder="Unit Price">
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="mb-2 mt-1">
                                <input type="text" class="form-control" disabled id="itemQty" aria-describedby="telHelp" placeholder="Available qty">
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-2 mt-1">
                                <input type="text" class="form-control" id="orderQty" aria-describedby="telHelp" placeholder="Order Qty">
                            </div>
                        </div>
                    </div>

                    <button type="button" id="btnAddToCart" class="btn btn-success float-end mb-3"> Add To Cart </button>
                </form>

            </div>
        </div>

        <div class="col">
            <div class="row">
                <div class="col-md-6">
                    <h3 class="mx-auto mt-lg-5 text-lg-center ms-5" style="color: #c2b09d">Cart Items</h3>
                </div>
            </div>

            <div class="row two mb-3">
                <section class="shadow-lg table-wrap2">
                    <table id="orderTable" class="table table-bordered table-hover mt-3 text-white">
                        <thead class="bg-dark">
                        <tr>
                            <th>Item Id</th>
                            <th>Name</th>
                            <th>Units</th>
                            <th>Unit Price</th>
                            <th class="w-25">Total</th>
                        </tr>
                        </thead>
                        <tbody id="order-body">
                        </tbody>
                    </table>
                </section>
            </div>

            <div class="row three">
                <form action="">
                    <div class="mb-3">
                        <input type="text" class="form-control text-white" disabled id="txtPureTot" aria-describedby="nameHelp" placeholder="Total">
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" id="txtDiscount" aria-describedby="nameHelp" placeholder="Discount %">
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" id="txtTotBil" disabled aria-describedby="nameHelp" placeholder="Total Bill">
                    </div>
                    <button type="button" id="btnCreateBill" class="btn btn-dark float-end mb-2"> Create Bill </button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="cont-04" class="container" style="display: none">
    <div class="row mt-lg-5">

        <div class="col">
            <div class="row">
                <div class="col-md-6">
                    <h3 class="mx-auto mt-lg-5 text-lg-center ms-5" style="color: #c2b09d">Order History</h3>

                    <div class="row">
                        <div class="col mb-2 mt-3">
                            <input type="text" class="form-control" id="searchID" aria-describedby="telHelp" placeholder="search ID Here">
                        </div>
                        <div class="col mt-3">
                            <button id="btnSearchOrder" class="btn btn-warning ms-2 mb-2" type="button"> Search </button>
                            <button id="btnReload" class="btn btn-success ms-2 mb-2" type="button"> Re-Load </button>
                        </div>

                    </div>
                   <!-- <canvas id="myChart" style="width:100%;max-width:600px; font-weight:bolder "></canvas>-->

                </div>
            </div>

            <div class="row two">

                <div class="col">

                    <h3 class="mx-auto mt-lg-5 text-lg-center ms-5" style="color: #b3b3b3; font-size: 22px">Orders</h3>
                    <section class="shadow-lg table-wrap">
                        <table class="table table-bordered table-hover mt-3 text-white" id="tblOrderDetail">
                            <thead class="bg-dark text-white">
                            <tr>
                                <th>Order Id</th>
                                <th>Customer Id</th>
                                <th>Date</th>
                                <th>Discount</th>
                                <th>Total Amount</th>
                            </tr>
                            </thead>
                            <tbody  id="tblOrderDetail-body">
                            </tbody>
                        </table>
                    </section>
                </div>

                <div class="col">
                    <h3 class="mx-auto mt-lg-5 text-lg-center" style="color: #afafaf; font-size: 22px">order-items</h3>
                    <section class="shadow-lg table-wrap">
                        <table class="table table-bordered table-hover mt-3 text-white" id="tblItemDetail">
                            <thead class="bg-dark text-white">
                            <tr>
                                <th>Item Code</th>
                                <th>Name</th>
                                <th>Qty</th>
                                <th>Unit Price</th>
                                <th>Total Amount</th>
                            </tr>
                            </thead>
                            <tbody id="tblItemDetail-body">
                            </tbody>
                        </table>
                    </section>
                </div>
            </div>

            <!--<div class="row-cols-1">
                <button type="submit" class="btn btn-danger mb-2" style="width: 70vw; margin-left: 6vw"> Delete Item </button>
            </div>-->

        </div>
    </div>
</div>

<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/jQuery/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script src="model/OrderDTO.js"></script>
<script src="Temp/TempArrays.js"></script>

<script>
    $("#register").click(function (){
        $("#cont-02").css("display","block");
        $("#cont-01").css("display","none");
        $("#cont-03").css("display","none");
        $("#cont-04").css("display","none");
    });

    $("#placeOrder").click(function (){
        $("#cont-02").css("display","none");
        $("#cont-01").css("display","none");
        $("#cont-03").css("display","block");
        $("#cont-04").css("display","none");
    });

    $("#orderHistory").click(function (){
        $("#cont-02").css("display","none");
        $("#cont-01").css("display","none");
        $("#cont-03").css("display","none");
        $("#cont-04").css("display","block");
    });

    $("#homePage").click(function (){
        $("#cont-02").css("display","none");
        $("#cont-01").css("display","block");
        $("#cont-03").css("display","none");
        $("#cont-04").css("display","none");
    });

    $(document).keydown(function(objEvent) {
        if (objEvent.keyCode === 9) {  //tab pressed
            objEvent.preventDefault(); // stops its action
        }
    });

    /*=================== Customer Config =======================*/

    $("#clearCusFields").click(function (){
        $("#txtCustomerId").val(null);
        $("#txtCustomerName").val(null);
        $("#txtEmail").val(null);
        $("#txtTelNo").val(null);
    });

    /*function bindClickEvents() {
        $("##customer-body>tr").click(function () {
            //Get values from the selected row
            let id = $(this).children().eq(0).text();
            let name = $(this).children().eq(1).text();
            let address = $(this).children().eq(2).text();
            let salary = $(this).children().eq(3).text();

            console.log(id,name,address,salary + " oooooo ");

            //Set values to the text-fields
            $("#txtCustomerId").val(id);
            $("#txtCustomerName").val(name);
            $("#txtEmail").val(address);
            $("#txtTelNo").val(salary);
        });
    }*/

    function loadCustomersToTextFields(row){
        let cusID = $(row).children(":eq(0)").text();
        let cusName = $(row).children(":eq(1)").text();
        let email = $(row).children(":eq(2)").text();
        let telNo = $(row).children(":eq(3)").text();

        console.log(cusID, cusName, email, telNo);

        $("#txtCustomerId").val(cusID);
        $("#txtCustomerName").val(cusName);
        $("#txtEmail").val(email);
        $("#txtTelNo").val(telNo);
    }

    $("#customer-body>tr").click(function (){
        loadCustomersToTextFields(this);
    });


    $( document ).ready(function() {
        loadAllCustomers();
    });

    function loadAllCustomers() {
        $("#customer-body").empty();
        $.ajax({
            url: "customer?option=GETALL",
            method: "GET",
            success: function (resp) {
                for (const customer of resp.data) {
                    let row = `<tr><td>${customer.id}</td><td>${customer.name}</td><td>${customer.email}</td><td>${customer.telNo}</td></tr>`;
                    $("#customerTable").append(row);
                }

                $("#customer-body>tr").click(function (){
                    loadCustomersToTextFields(this);
                });
            }
        });
    }

    $("#addNewCustomer").click(function (){

        let data = $("#customerForm").serialize();
        $.ajax({
            url: "customer",
            method: "POST",
            data:data,
            success:function (res){
                if (res.status === 200) {
                    alert(res.message);
                    loadAllCustomers();
                } else {
                    alert(res.data);
                }
            }
        })
    });

    $("#btnDeleteCustomer").click(function (){
        let customerID = $("#txtCustomerId").val();

        $.ajax({
            url:"customer?CusID="+customerID,
            method: "DELETE",
            success:function (res){
                console.log(res);
                if (res.status === 200) {
                    alert(res.message);
                    loadAllCustomers();
                } else if (res.status === 400) {
                    alert(res.data);
                } else {
                    alert(res.data);
                }
            },
            error:function (ob, status, t){
                console.log(ob);
                console.log(status);
                console.log(t);
            }
        })
    });

    $("#updateCustomer").click(function (){
        var cusOb = {
            id: $("#txtCustomerId").val(),
            name: $("#txtCustomerName").val(),
            address: $("#txtEmail").val(),
            salary: $("#txtTelNo").val()
        }

        $.ajax({
            url: "customer",
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify(cusOb), // format js object to valid json string
            success: function (res) {
                if (res.status === 200) {
                    alert(res.message);
                    loadAllCustomers();
                } else if (res.status === 400) {
                    alert(res.message);
                } else {
                    alert(res.data);
                }
            },
            error: function (ob, errorStus) {
                console.log(ob);
            }
        });
    });

    /*=================== Item Config =======================*/

    $("#clearItemFields").click(function (){
        $("#txtItemCode").val(null);
        $("#txtItemName").val(null);
        $("#txtQty").val(null);
        $("#txtUnitPrice").val(null);
    });

    /*function bindClickEvents() {
        $("##customer-body>tr").click(function () {
            //Get values from the selected row
            let id = $(this).children().eq(0).text();
            let name = $(this).children().eq(1).text();
            let address = $(this).children().eq(2).text();
            let salary = $(this).children().eq(3).text();

            console.log(id,name,address,salary + " oooooo ");

            //Set values to the text-fields
            $("#txtCustomerId").val(id);
            $("#txtCustomerName").val(name);
            $("#txtEmail").val(address);
            $("#txtTelNo").val(salary);
        });
    }*/

    function loadItemsToTextFields(row){
        let itemID = $(row).children(":eq(0)").text();
        let itemName = $(row).children(":eq(1)").text();
        let uniPrice = $(row).children(":eq(2)").text();
        let qty = $(row).children(":eq(3)").text();

        console.log(itemID, itemName, qty, uniPrice);

        $("#txtItemCode").val(itemID);
        $("#txtItemName").val(itemName);
        $("#txtQty").val(qty);
        $("#txtUnitPrice").val(uniPrice);
    }

    $("#item-body>tr").click(function (){
        loadItemsToTextFields(this);
    });

    $( document ).ready(function() {
        loadAllItems();
    });

    function loadAllItems() {
        $("#item-body").empty();
        $.ajax({
            url: "item?option=GETALL",
            method: "GET",
            success: function (resp) {
                for (const item of resp.data) {
                    let row = `<tr><td>${item.code}</td><td>${item.name}</td><td>${item.price}</td><td>${item.qty}</td></tr>`;
                    $("#itemTable").append(row);
                }

                $("#item-body>tr").click(function (){
                    loadItemsToTextFields(this);
                });
            }
        });
    }

    $("#addNewItem").click(function (){

        let data = $("#itemForm").serialize();
        $.ajax({
            url: "item",
            method: "POST",
            data:data,
            success:function (res){
                if (res.status === 200) {
                    alert(res.message);
                    loadAllItems();
                } else {
                    alert(res.data);
                }
            }
        })
    });

    $("#dltItem").click(function (){
        let itemCode = $("#txtItemCode").val();

        $.ajax({
            url:"item?itemID="+itemCode,
            method: "DELETE",
            success:function (res){
                console.log(res);
                if (res.status === 200) {
                    alert(res.message);
                    loadAllItems();
                } else if (res.status === 400) {
                    alert(res.data);
                } else {
                    alert(res.data);
                }
            },
            error:function (ob, status, t){
                console.log(ob);
                console.log(status);
                console.log(t);
            }
        })
    });

    $("#updateItem").click(function (){
        var itemOb = {
            id: $("#txtItemCode").val(),
            name: $("#txtItemName").val(),
            price: $("#txtUnitPrice").val(),
            qty: $("#txtQty").val()
        }

        $.ajax({
            url: "item",
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify(itemOb), // format js object to valid json string
            success: function (res) {
                if (res.status === 200) {
                    alert(res.message);
                    loadAllItems();
                } else if (res.status === 400) {
                    alert(res.message);
                } else {
                    alert(res.data);
                }
            },
            error: function (ob, errorStus) {
                console.log(ob);
            }
        });
    });

    /*=================== Order Config =======================*/

    $("#placeOrder").click(function (){
        $("#customerID-selector").empty();
        $.ajax({
            url: "customer?option=GETIDS",
            method: "GET",
            success: function (resp) {
                for (const customer of resp.data) {
                    let row = `<option value="${customer.id}">${customer.id}</option>`;
                    $("#customerID-selector").append(row);
                }
            }
        });

        $("#itemID-selector").empty();
        $.ajax({
            url: "item?option=GETIDS",
            method: "GET",
            success: function (resp) {
                for (const item of resp.data) {
                    let row = `<option value="${item.code}">${item.code}</option>`;
                    $("#itemID-selector").append(row);
                }
            }
        });
    });

    $("#customerID-selector").click(function (){
        var customerID = $("#customerID-selector").val();
        console.log(customerID + " this is ID");

        $.ajax({
            url: "customer?option=GETCUSTOMER&id="+customerID,
            method: "GET",
            success: function (resp) {
                console.log(resp.data.id + " ado " + resp.data.name + "  ,  " + resp.data.email);
                $("#customName").val(resp.data.name);
                $("#customAddress").val(resp.data.email);
                $("#customTelNo").val(resp.data.telNo);
            }
        });
    });

    $("#itemID-selector").click(function (){
        var itemID = $("#itemID-selector").val();
        console.log(itemID + " this is ID");

        $.ajax({
            url: "item?option=GETITEM&code="+itemID,
            method: "GET",
            success: function (resp) {
                console.log(resp.data.id + " ado " + resp.data.name + "  ,  " + resp.data.price);
                $("#itemName").val(resp.data.name);
                $("#unitPrice").val(resp.data.price);
                $("#itemQty").val(resp.data.qty);
            }
        });
    });

    $("#btnAddToCart").click(function (){
        addOrderToTable();
    });

    function addOrderToTable(){
        const id = $("#itemID-selector").val();
        const name = $("#itemName").val();
        const price = $("#unitPrice").val();
        const qty = $("#orderQty").val();
        const customerId = $("#customerID-selector").val();

        const tot = price * qty;

        let orderID="O-0001";

        let orderArray = new OrderDTO(orderID,customerId,id,name,qty,price,tot);

        console.log(orderArray);

        if(id !== '' && qty !=='' &&  customerId !== ''){

            let orQty = $("#itemQty").val();

            console.log(qty + " < > = " + orQty);

            if( Number(qty) < Number(orQty) ){

                let isExists=false;
                let index;
                let oldQty;
                let oldTot;

                if(orders.length === 0){
                    isExists = false;
                }else{
                    for (const i in orders) {
                        if(orders[i].getORDItemId() === id){
                            isExists = true;
                            index=i;
                            oldQty=orders[i].getORDUnits();
                            oldTot=orders[i].getORDTotal();
                        }
                    }
                }

                if(isExists){
                    orders[index].setORDUnits(Number(oldQty) + Number(qty));
                    orders[index].setORDTotal(Number(tot) + Number(oldTot));

                    loadAllItemsToOrderTable();

                }else{
                    orders.push(orderArray);

                    let i = orders.length-1;

                    let row = `<tr><td>${orders[i].getORDItemId()}</td><td>${orders[i].getORDItemName()}</td><td>${orders[i].getORDUnits()}</td>
                            <td>${orders[i].getORDUnitPrice()}</td><td>${orders[i].getORDTotal()}</td></tr>`;
                    $("#orderTable").append(row);
                }
            }else{
                alert("Quantity not sufficient !!")
            }

        }else{
            alert("Please check all inputs in item form");
        }
    }



</script>

</body>
</html>